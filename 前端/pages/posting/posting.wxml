<view class="posting-container">
  <view class="page-header">
    <view class="page-title-container">
      <text class="page-title">分享猫咪故事</text>
      <view class="cat-icon">
        <view class="cat-ear left"></view>
        <view class="cat-ear right"></view>
        <view class="cat-face"></view>
      </view>
    </view>
    <text class="page-subtitle">记录你与猫咪的点滴时光</text>
  </view>
  
  <view class="form-section">
    <!-- 优化图片上传区域 -->
    <view class="input-group photo-upload">
      <view class="upload-label">添加照片</view>
      <view class="upload-area">
        <view class="upload-preview">
          <image wx:if="{{postingForm.photo}}" class="preview-img" src="{{postingForm.photo}}" mode="aspectFill"></image>
          <view wx:else class="default-preview">
            <image class="default-img" src="../../assets/Abyssinian_11.jpg" mode="aspectFill"></image>
          </view>
          <view class="image-overlay">
            <view class="overlay-text">{{postingForm.photo ? '更换图片' : '默认图片'}}</view>
          </view>
        </view>
        
        <view class="upload-options">
          <button class="upload-btn primary" bindtap="onChoosePhoto">
            <view class="btn-icon">+</view>
            <text>{{postingForm.photo ? '更换' : '上传'}}</text>
          </button>
          <button wx:if="{{postingForm.photo}}" class="upload-btn secondary" bindtap="removePhoto">
            <text>移除</text>
          </button>
        </view>
      </view>
    </view>

    <view class="input-group">
      <view class="input-label">
        <text>标题</text>
        <text class="required-mark">*</text>
      </view>
      <view class="input-container">
        <input class="input title-input" type="text" placeholder="给你的猫咪故事起个标题" value="{{postingForm.title}}" bindinput="onPostingTitleInput" />
        <view class="char-count {{postingForm.title.length >= 25 ? 'near-limit' : ''}}">{{postingForm.title.length}}/30</view>
      </view>
    </view>

    <view class="input-group">
      <view class="input-label">
        <text>内容</text>
        <text class="required-mark">*</text>
      </view>
      <view class="input-container">
        <textarea class="textarea content-input" placeholder="分享关于你猫咪的故事..." value="{{postingForm.content}}" bindinput="onPostingContentInput" maxlength="300" />
        <view class="char-count {{postingForm.content.length >= 250 ? 'near-limit' : ''}}">{{postingForm.content.length}}/300</view>
      </view>
    </view>

    <view class="category-section">
      <view class="input-label">猫咪标签</view>
      <view class="tag-container">
        <view class="tag {{selectedTag === '流浪猫' ? 'active' : ''}}" bindtap="selectTag" data-tag="流浪猫">流浪猫</view>
        <view class="tag {{selectedTag === '家养猫' ? 'active' : ''}}" bindtap="selectTag" data-tag="家养猫">家养猫</view>
        <view class="tag {{selectedTag === '救助' ? 'active' : ''}}" bindtap="selectTag" data-tag="救助">救助</view>
        <view class="tag {{selectedTag === '领养' ? 'active' : ''}}" bindtap="selectTag" data-tag="领养">领养</view>
        <view class="tag {{selectedTag === '喂养' ? 'active' : ''}}" bindtap="selectTag" data-tag="喂养">喂养</view>
      </view>
    </view>

    <button class="submit-btn" bindtap="handlePosting" disabled="{{isUploading}}">
      <text>{{isUploading ? '发布中...' : '发布'}}</text>
      <view class="paw-print"></view>
    </button>
  </view>
</view>
